{{!--
/**
 * Spell List Manager Selected List Content Template
 *
 * PURPOSE:
 * Main content panel for displaying and managing the currently selected spell list.
 * Provides spell list header with action controls, spell display organized by level,
 * and editing capabilities including individual and bulk spell removal. Supports
 * different list types with appropriate action sets and state management.
 *
 * CONTEXT REQUIREMENTS:
 * @param {Object} selectedSpellList - Currently selected spell list data
 * @param {string} selectedSpellList.name - Display name of the spell list
 * @param {string} selectedSpellList.uuid - Unique identifier for the spell list
 * @param {boolean} selectedSpellList.isRenameable - Whether list can be renamed
 * @param {boolean} selectedSpellList.isPlayerSpellbook - Whether list is a player spellbook
 * @param {boolean} selectedSpellList.isClassSpellList - Whether list is a class spell list
 * @param {boolean} selectedSpellList.canRestore - Whether list can be restored to original
 * @param {boolean} selectedSpellList.isLoadingSpells - Whether spells are currently loading
 * @param {boolean} selectedSpellList.hasError - Whether list has error state
 * @param {Array<Object>} selectedSpellList.spells - Array of spells in the list
 * @param {Array<Object>} selectedSpellList.spellsByLevel - Spells organized by level
 * @param {Object} selectedSpellList.compareInfo - Comparison information for modified lists
 * @param {boolean} selectedSpellList.compareInfo.hasOriginalChanged - Whether original has updates
 * @param {boolean} isEditing - Whether spell list manager is in editing mode
 * @param {boolean} selectionMode - Whether bulk selection mode is active
 * @param {boolean} isLoading - Whether application is in loading state
 * @param {string} selectAllRemoveCheckboxHtml - HTML for select all removal checkbox
 * @param {Object} selectedSpellsToRemove - Map of spells selected for removal
 *
 * HELPER DEPENDENCIES:
 * @requires localize - Foundry VTT localization helper for text translation
 * @requires if - Handlebars conditional helper for state checks
 * @requires unless - Handlebars inverse conditional helper
 * @requires each - Handlebars iteration helper for spell collections
 * @requires and - Handlebars logical AND helper for condition checking
 * @requires lookup - Handlebars object property lookup helper
 * @requires > - Handlebars partial inclusion helper for shared components
 * @requires ifThen - Custom helper for conditional value selection
 *
 * ACCESSIBILITY FEATURES:
 * - Main section role with descriptive aria-label
 * - Toolbar role for action button groups with proper labeling
 * - Header structure with proper heading hierarchy
 * - Status regions for loading and update notifications
 * - Button elements with comprehensive aria-label attributes
 * - List structures with role="listitem" for spell items
 * - Live regions for dynamic content updates
 *
 * CUSTOMIZATION POINTS:
 * - Action buttons adapt based on list type and permissions
 * - Editing controls toggle based on editing and selection modes
 * - Spell display uses shared spell level component for consistency
 * - Empty states adapt based on editing mode context
 * - Loading and error states use shared components
 *
 * INTEGRATION:
 * - Connects to SpellListManager application for list management
 * - Uses shared components for loading, error, and empty states
 * - Supports spell comparison dialog integration
 * - Integrates with bulk selection and individual removal workflows
 * - Works with list restore and modification tracking systems
 */
--}}

<section class="selected-list-content" role="main" aria-label="{{localize 'SPELLMANAGER.UI.SelectedList'}}">
	{{#if selectedSpellList}}
		<!-- Selected List Header - Title and action controls -->
		<div class="selected-list-header">
			<div class="header-title">
				<h2 id="selected-list-title">{{selectedSpellList.name}}</h2>
			</div>

			<!-- Header Action Buttons - Context-sensitive list management controls -->
			<div class="header-buttons" role="toolbar" aria-label="{{localize 'SPELLMANAGER.UI.ListActions'}}">
				{{#unless isEditing}}
					<!-- View Mode Actions -->

					<!-- Edit List Button -->
					<button type="button" class="edit-button action-button" data-action="editSpellList"
						data-uuid="{{selectedSpellList.uuid}}" aria-label="{{localize 'SPELLMANAGER.Buttons.Edit'}}">
						<i class="fas fa-edit" aria-hidden="true"></i> {{localize "SPELLMANAGER.Buttons.Edit"}}
					</button>

					<!-- Rename List Button - Only for renameable lists -->
					{{#if selectedSpellList.isRenameable}}
						<button type="button" class="rename-button action-button" data-action="renameSpellList"
							data-uuid="{{selectedSpellList.uuid}}" aria-label="{{localize 'SPELLMANAGER.Buttons.Rename'}}"
							data-tooltip="{{localize 'SPELLMANAGER.Tooltips.Rename'}}">
							<i class="fas fa-pen" aria-hidden="true"></i> {{localize "SPELLMANAGER.Buttons.Rename"}}
						</button>
					{{/if}}

					<!-- Open Actor Button - For player spellbooks -->
					{{#if selectedSpellList.isPlayerSpellbook}}
						<button type="button" class="open-actor-button action-button" data-action="openActor"
							aria-label="{{localize 'SPELLMANAGER.Buttons.OpenActor'}}">
							<i class="fas fa-user" aria-hidden="true"></i> {{localize "SPELLMANAGER.Buttons.OpenActor"}}
						</button>
					{{/if}}

					<!-- Open Class Button - For class spell lists -->
					{{#if selectedSpellList.isClassSpellList}}
						<button type="button" class="open-class-button action-button" data-action="openClass"
							aria-label="{{localize 'SPELLMANAGER.Buttons.OpenClass'}}">
							<i class="fas fa-scroll" aria-hidden="true"></i> {{localize "SPELLMANAGER.Buttons.OpenClass"}}
						</button>
					{{/if}}
				{{else}}
					<!-- Edit Mode Actions - Custom list management controls -->
					<div class="custom-list-controls">
						{{#if selectedSpellList.canRestore}}
							<!-- Update Notification - Shows when original list has changed -->
							{{#if selectedSpellList.compareInfo.hasOriginalChanged}}
								<span class="update-notice" role="status">{{localize "SPELLMANAGER.Status.UpdateNotice"}}</span>
							{{/if}}

							<!-- Restore to Original Button -->
							<button type="button" class="restore-button action-button" data-action="restoreOriginal"
								data-uuid="{{selectedSpellList.uuid}}" aria-label="{{localize 'SPELLMANAGER.Buttons.Restore'}}">
								<i class="fas fa-sync" aria-hidden="true"></i> {{localize "SPELLMANAGER.Buttons.Restore"}}
							</button>
						{{/if}}

						<!-- Delete Custom List Button -->
						<button type="button" class="delete-button action-button" data-action="deleteCustomList"
							data-uuid="{{selectedSpellList.uuid}}" aria-label="{{localize 'SPELLMANAGER.Buttons.Delete'}}">
							<i class="fas fa-trash" aria-hidden="true"></i> {{localize "SPELLMANAGER.Buttons.Delete"}}
						</button>

						<!-- Save Custom List Button -->
						<button type="button" class="save-button action-button" data-action="saveCustomList"
							data-uuid="{{selectedSpellList.uuid}}" aria-label="{{localize 'SPELLMANAGER.Buttons.Save'}}">
							<i class="fas fa-save" aria-hidden="true"></i> {{localize "SPELLMANAGER.Buttons.Save"}}
						</button>
					</div>
				{{/unless}}

				<!-- Bulk Selection Control - Select all for removal during selection mode -->
				{{#if (and isEditing selectionMode)}}
					<div class="select-all-remove-container">
						<span class="selection-label">{{localize "SPELLMANAGER.Selection.SelectAllToRemove"}}</span>
						{{{selectAllRemoveCheckboxHtml}}}
					</div>
				{{/if}}
			</div>
		</div>

		<!-- Selected List Spells Display -->
		<div class="selected-list-spells" aria-labelledby="selected-list-title">
			{{#if selectedSpellList.isLoadingSpells}}
				<!-- Loading State -->
				{{> "modules/spell-book/templates/components/loading-spinner.hbs" size=2 message=(localize "SPELLMANAGER.Application.LoadingSpells")}}
			{{else if selectedSpellList.hasError}}
				<!-- Error State -->
				{{> "modules/spell-book/templates/components/error-message.hbs" message=(localize "SPELLMANAGER.Application.SpellsError")}}
			{{else if selectedSpellList.spells.length}}
				<!-- Spells Content - Organized by spell level using shared component -->
				<div class="spells-container">
					{{#each selectedSpellList.spellsByLevel as |levelData|}}
						{{#> "modules/spell-book/templates/components/spell-level.hbs" level=levelData.level levelName=levelData.levelName spells=levelData.spells}}
							<!-- Individual Spell Item within spell level component -->
							<li
								class="spell-item{{#if ../../selectionMode}} selectable{{/if}}{{#if (lookup ../../selectedSpellsToRemove compendiumUuid)}} selected{{/if}}"
								data-uuid="{{compendiumUuid}}" data-selection-type="remove" role="listitem">

								<!-- Spell Name and Details -->
								<div class="spell-name">
									{{{enrichedIcon}}}
									<div class="name-stacked">
										<span class="title">{{name}}</span>
										<span class="subtitle">{{#if showCompareLink}}{{#if showCompare}}<button
														class="compare-button compare-link{{#if isInComparison}} active{{/if}}"
														data-action="compareSpell" data-uuid="{{compendiumUuid}}"
														aria-label="{{localize 'SPELLBOOK.Comparison.CompareSpell' name=name}}"
														data-tooltip="{{localize "SPELLBOOK.Comparison.Compare"}}">
														<i class="fa-solid fa-clipboard-question"></i>
													</button> {{/if}}{{/if}}{{formattedDetails}}</span>
									</div>
								</div>

								<!-- Spell Removal Controls - Available during editing -->
								{{#if ../../isEditing}}
									<div class="spell-preparation">
										{{#if ../../selectionMode}}
											<!-- Bulk Selection Checkbox -->
											{{{selectRemoveCheckboxHtml}}}
										{{else}}
											<!-- Individual Remove Button -->
											<button type="button" class="remove-spell" data-action="removeSpell"
												data-uuid="{{compendiumUuid}}"
												aria-label="{{localize 'SPELLMANAGER.Buttons.RemoveSpell' name=name}}">
												<i class="fas fa-trash" aria-hidden="true"></i>
											</button>
										{{/if}}
									</div>
								{{/if}}
							</li>
							{{/modules/spell-book/templates/components/spell-level.hbs}}
					{{/each}}
				</div>
			{{else}}
				<!-- Empty List State - Context-sensitive messaging -->
				{{> "modules/spell-book/templates/components/empty-state.hbs" message=(ifThen isEditing (localize "SPELLMANAGER.Columns.AddSpellsPrompt") (localize "SPELLMANAGER.Columns.NoSpells"))}}
			{{/if}}
		</div>
	{{else}}
		<!-- No List Selected State -->
		{{#unless isLoading}}
			<div class="no-selection">
				<p>{{localize "SPELLMANAGER.Columns.NoListSelected"}}</p>
			</div>
		{{/unless}}
	{{/if}}
</section>
