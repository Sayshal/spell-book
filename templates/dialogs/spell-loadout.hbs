<div class="spell-loadout-dialog-form">
  <!-- Loadout Header with Class Information -->
  <div class="loadout-header">
    <h3>{{localize 'SPELLBOOK.Loadouts.ManageLoadoutsTitle'}}</h3>
    <p class="class-info">
      {{localize 'SPELLBOOK.Loadouts.ClassInfo' class=className count=currentSpellCount}}
    </p>
  </div>

  <!-- Create New Loadout Section -->
  <fieldset class="loadout-section create-loadout">
    <legend>{{localize 'SPELLBOOK.Loadouts.CreateNew'}}</legend>

    <!-- Loadout Name Input -->
    <div class="form-group">
      <label for="loadout-name">{{localize 'SPELLBOOK.Loadouts.LoadoutName'}}</label>
      {{{nameInputHtml}}}
    </div>

    <!-- Loadout Description Input -->
    <div class="form-group">
      <label for="loadout-description">{{localize 'SPELLBOOK.Loadouts.LoadoutDescription'}}</label>
      {{{descriptionInputHtml}}}
    </div>

    <!-- Save Current Loadout Action -->
    <div class="form-actions">
      <button type="button" data-action="save" class="save-loadout-btn">
        <i class="fas fa-save"></i>
        {{localize 'SPELLBOOK.Loadouts.SaveCurrent'}}
      </button>
    </div>
  </fieldset>

  <!-- Existing Loadouts Management Section -->
  {{#if existingLoadouts.length}}
    <fieldset class="loadout-section existing-loadouts">
      <legend>{{localize 'SPELLBOOK.Loadouts.ExistingLoadouts'}}</legend>

      <!-- Loadouts List -->
      <div class="loadout-list">
        {{#each existingLoadouts as |loadout|}}
          <div class="loadout-item">
            <!-- Loadout Title Row - Name, description, and preview -->
            <div class="loadout-title">
              <div class="loadout-text">
                <span class="loadout-name">{{loadout.name}}</span>{{#if loadout.description}}. <span
                    class="loadout-description">{{loadout.description}}</span>{{/if}}
              </div>
              {{#if loadout.spellCount}}
                <i class="fas fa-eye spell-preview-icon" data-loadout-id="{{loadout.id}}">
                </i>
              {{/if}}
            </div>

            <!-- Loadout Actions Row - Management buttons -->
            <div class="loadout-actions">
              <!-- Apply Loadout Button -->
              <button type="button" data-action="apply" data-loadout-id="{{loadout.id}}"
                class="apply-loadout-btn">
                <i class="fas fa-check"></i>
                {{localize 'SPELLBOOK.Loadouts.Apply'}}
              </button>

              <!-- Overwrite Loadout Button -->
              <button type="button" data-action="overwrite" data-loadout-id="{{loadout.id}}"
                data-loadout-name="{{loadout.name}}" class="overwrite-loadout-btn">
                <i class="fas fa-sync-alt"></i>
                {{localize 'SPELLBOOK.Loadouts.Overwrite'}}
              </button>

              <!-- Delete Loadout Button -->
              <button type="button" data-action="delete" data-loadout-id="{{loadout.id}}"
                data-loadout-name="{{loadout.name}}" class="delete-loadout-btn">
                <i class="fas fa-trash"></i>
                {{localize 'SPELLBOOK.Loadouts.Delete'}}
              </button>
            </div>

            <!-- Loadout Metadata Footer -->
            <div class="loadout-footer">
              <div class="loadout-meta">
                {{localize 'SPELLBOOK.Loadouts.SpellCount' count=loadout.spellCount}}{{#if loadout.formattedDate}} â€¢
                  {{localize 'SPELLBOOK.Loadouts.LastUpdated' date=loadout.formattedDate}}{{/if}}
              </div>
            </div>
          </div>
        {{/each}}
      </div>
    </fieldset>
  {{else}}
    <!-- No Loadouts State -->
    <div class="no-loadouts">
      <p>{{localize 'SPELLBOOK.Loadouts.NoLoadouts'}}</p>
    </div>
  {{/if}}
</div>
